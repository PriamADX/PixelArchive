<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>PixelArchive</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    input {
      width: 100%;
      padding: 10px;
      margin: 20px 0;
      font-size: 16px;
    }

    .item {
      background: #1e1e1e;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
    }

    a {
      color: #00ffcc;
      text-decoration: none;
      font-weight: bold;
    }

    .admin {
      color: gold;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>üì¶ PixelArchive</h1>

<input type="text" id="search" placeholder="üîç Rechercher un fichier...">

<div id="list"></div>

<script>
const SHEET_CSV =
"https://docs.google.com/spreadsheets/d/1LyUjqpyXucK97PMsuQH5wjU7PQj-LWZYunfuN1Pl5NM/export?format=csv";

const ADMIN_MAIL = "priamadx@gmail.com";

fetch(SHEET_CSV)
  .then(r => r.text())
  .then(text => {
    const lignes = text.split("\n").slice(1);
    window.data = lignes.map(l => l.split(","));
    afficher(data);
  });

function afficher(data) {
  const list = document.getElementById("list");
  list.innerHTML = "";

  data.forEach(ligne => {
    if (ligne.length < 4) return;

    const titre = ligne[1];
    const lien = ligne[2];
    const mail = ligne[3];

    if (!titre || !lien) return;

    // üë§ QUI A UPLOAD
    let pseudo = "Inconnu üëÄ";
    if (mail) pseudo = mail.split("@")[0];

    // üëë BONUS ADMIN
    let badge = "";
    if (mail === ADMIN_MAIL) badge = " <span class='admin'>üëë ADMIN</span>";

    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <h3>${titre}</h3>
      <p>üë§ Ajout√© par : ${pseudo}${badge}</p>
      <a href="${lien}" download>‚¨áÔ∏è T√©l√©charger</a>
    `;
    list.appendChild(div);
  });
}

// üîç BARRE DE RECHERCHE
document.getElementById("search").addEventListener("input", e => {
  const v = e.target.value.toLowerCase();
  const filtre = data.filter(l =>
    l[1] && l[1].toLowerCase().includes(v)
  );
  afficher(filtre);
});
</script>

</body>
</html>
