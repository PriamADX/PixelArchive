<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>PixelArchive</title>

  <style>
    body {
      background: #111;
      color: white;
      font-family: Arial;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #00ffcc;
    }

    .file {
      background: #222;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 10px;
    }

    a {
      color: black;
      background: #00ffcc;
      padding: 6px 10px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      margin-top: 5px;
    }
  </style>
</head>

<body>

<h1>ğŸ“¦ PixelArchive</h1>

<div id="files">Chargement...</div>

<!-- ğŸ§  LE CERVEAU DU SITE -->
<script>

const SHEET_URL =
"https://docs.google.com/spreadsheets/d/1LyUjqpyXucK97PMsuQH5wjU7PQj-LWZYunfuN1Pl5NM/export?format=csv";

fetch(SHEET_URL)
  .then(res => res.text())
  .then(text => {

    const lignes = text.split("\n").slice(1);
    const zone = document.getElementById("files");
    zone.innerHTML = "";

    lignes.forEach(ligne => {

      // ğŸ” chercher le lien Drive dans la ligne
      const lienMatch = ligne.match(/https:\/\/drive\.google\.com[^\s"]+/);
      if (!lienMatch) return;

      const lien = lienMatch[0];

      // ğŸ§  rÃ©cupÃ©rer lâ€™ID du fichier
      const idMatch =
        lien.match(/id=([^&]+)/) || lien.match(/\/d\/([^/]+)/);
      if (!idMatch) return;

      const id = idMatch[1];
      const download =
        "https://drive.google.com/uc?export=download&id=" + id;

      // ğŸ“ titre simple
      const titre = ligne.split(",")[1] || "Sans titre";

      zone.innerHTML += `
        <div class="file">
          <h3>${titre}</h3>
          <a href="${download}" target="_blank">â¬‡ï¸ TÃ©lÃ©charger</a>
        </div>
      `;
    });

    if (zone.innerHTML === "") {
      zone.innerHTML = "âŒ Aucun fichier trouvÃ©";
    }

  });

</script>

</body>
</html>
